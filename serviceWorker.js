const CACHE_NAME="likexiaCat",locationUrl=location.origin+location.pathname.replace("serviceWorker.js",""),cdn="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-y/",strap="https://petercheney.github.io/strap/",cdnCache=[cdn+"lz-string/1.4.1/lz-string.js",cdn+"jquery/3.6.0/jquery.min.js",cdn+"react/0.14.10/react.min.js",cdn+"dojo/1.6.0/dojo.xd.js",cdn+"systemjs/0.21.6/system.js",strap+"strapdown.js",strap+"strapdown.css",strap+"themes/litera.min.css",strap+"themes/bootstrap-responsive.min.css"],CACHE_LIST=["lf3-cdn-tos.bytecdntp.com",location.host,"petercheney.github.io"];self.addEventListener("install",e=>{e.waitUntil(caches.open("cdn").then(e=>e.addAll(cdnCache)).then(()=>self.skipWaiting()))}),self.addEventListener("activate",e=>{e.waitUntil(caches.open(CACHE_NAME).then(function(e){return e.delete(locationUrl+"index.html",{ignoreSearch:!0}).then(()=>e.delete(locationUrl,{ignoreSearch:!0}))}).then(()=>{caches.open("cdn").then(e=>e.addAll(cdnCache)).then(()=>self.clients.claim())}))}),self.addEventListener("fetch",function(e){let c=e.request,t=c.url,s=new URL(t);var n=t.includes("server.json");let r=t.includes("build.version.json");-1<CACHE_LIST.indexOf(s.host)&&e.respondWith(caches.match(c,{ignoreSearch:r||n}).then(function(e,t){let n=!0;if(e){if(!navigator.onLine)return e;if(n=s.search&&r?!1:n)return e}return fetch(c,{cache:"no-cache"}).then(function(e){if(!e||200!==e.status||"basic"!==e.type)return e;let t=e.clone();return caches.open(CACHE_NAME).then(function(e){return e.delete(c,{ignoreSearch:!0}).then(()=>e.put(c,t))}),e}).catch(()=>{if(e)return e})}))}),self.addEventListener("error",e=>{console.log(e)});